(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{444:function(_,v,e){"use strict";e.r(v);var t=e(65),o=Object(t.a)({},(function(){var _=this,v=_.$createElement,e=_._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[e("p",[_._v("交易流程")]),_._v(" "),e("h1",{attrs:{id:"交易管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#交易管理"}},[_._v("#")]),_._v(" 交易管理")]),_._v(" "),e("h2",{attrs:{id:"一、自营交易管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、自营交易管理"}},[_._v("#")]),_._v(" 一、自营交易管理")]),_._v(" "),e("ol",[e("li",[e("code",[_._v("checkStep")]),_._v(" : 检查步骤")]),_._v(" "),e("li",[e("code",[_._v("saveStep")]),_._v(" ： 落库步骤")]),_._v(" "),e("li",[e("code",[_._v("splitStep")]),_._v(" ：拆分步骤")]),_._v(" "),e("li",[e("code",[_._v("sendStep")]),_._v(" ： 发送步骤")])]),_._v(" "),e("h3",{attrs:{id:"_1、交易检查-checkstep"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、交易检查-checkstep"}},[_._v("#")]),_._v(" 1、交易检查 "),e("code",[_._v("checkStep")])]),_._v(" "),e("h3",{attrs:{id:"_2、交易落库-savestep"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、交易落库-savestep"}},[_._v("#")]),_._v(" 2、交易落库 "),e("code",[_._v("saveStep")])]),_._v(" "),e("h3",{attrs:{id:"_3、交易拆分-splitstep"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、交易拆分-splitstep"}},[_._v("#")]),_._v(" 3、交易拆分 "),e("code",[_._v("splitStep")])]),_._v(" "),e("ol",[e("li",[e("p",[_._v("检查发送头寸开关是否启用")]),_._v(" "),e("ol",[e("li",[_._v("系统参数："),e("code",[_._v("SEND_POSITION_SWITCH")])]),_._v(" "),e("li",[_._v("如果未启用，设置头寸状态 "),e("code",[_._v("positionCountStatus=6")]),_._v("：头寸发送关闭，更新 "),e("code",[_._v("fmut2_trade_bookkeeping")]),_._v(" 表")]),_._v(" "),e("li",[_._v("如果启动 执行以下流程：")])])]),_._v(" "),e("li",[e("p",[_._v("进行交易拆分")]),_._v(" "),e("ol",[e("li",[_._v("即期交易拆分\n"),e("ol",[e("li",[_._v("如果是 "),e("code",[_._v("直盘")]),_._v(" 或者 "),e("code",[_._v("人民币金CNYPMSPOT")]),_._v(" "),e("ol",[e("li",[_._v("组装现金流")]),_._v(" "),e("li",[_._v("组装头寸")]),_._v(" "),e("li",[_._v("设置发送头寸状态 "),e("code",[_._v("isSendPosition=1")]),_._v(" 为已发送")]),_._v(" "),e("li",[_._v("设置发送现金流状态 "),e("code",[_._v("sendCashFlowFlag=1")]),_._v(" 为已发送")]),_._v(" "),e("li",[_._v("设置头寸统计状态 "),e("code",[_._v("positionCountStatus=2")]),_._v(" 为统计中")]),_._v(" "),e("li",[_._v("设置 "),e("code",[_._v("ReceivePositionPojo")]),_._v(" 对象")]),_._v(" "),e("li",[_._v("返回最终对象")])])]),_._v(" "),e("li",[_._v("如果是 "),e("code",[_._v("交叉盘")]),_._v(" "),e("ol",[e("li",[_._v("交易拆分")]),_._v(" "),e("li",[_._v("拆分后的bookKeeping落库")]),_._v(" "),e("li",[_._v("设置源bookKeeping状态\n"),e("ol",[e("li",[_._v("发送头寸状态为不发送")]),_._v(" "),e("li",[_._v("发送现金流状态为不发送")]),_._v(" "),e("li",[_._v("头寸统计状态为统计中")]),_._v(" "),e("li",[_._v("设置拆分账户")]),_._v(" "),e("li",[_._v("更新源bookKeeping记录")])])]),_._v(" "),e("li",[_._v("遍历拆分后交易\n"),e("ol",[e("li",[_._v("组装现金流")]),_._v(" "),e("li",[_._v("组装头寸")]),_._v(" "),e("li",[_._v("组装内部交易1、2\n"),e("ol",[e("li",[_._v("内部交易bookKeeping落库")]),_._v(" "),e("li",[_._v("内部交易组装现金流、头寸")]),_._v(" "),e("li",[_._v("如果是贵金属交易且是结售汇："),e("code",[_._v("Instrument=PMSPOT and USDCNY = pair")]),_._v(" "),e("ol",[e("li",[_._v("发送对公系统FMTP, 只送与自己方向相反的一笔交易")])])]),_._v(" "),e("li",[_._v("如果不是： 两笔内部交易需要推送"),e("code",[_._v("复杂系统")])])])])])]),_._v(" "),e("li",[_._v("返回组装后对象 ： "),e("code",[_._v("tradeSendPojoResult")])])])])])]),_._v(" "),e("li",[_._v("远期交易拆分\n"),e("ol",[e("li",[_._v("贵金属远期不记录头寸和现金流")]),_._v(" "),e("li",[_._v("通过 "),e("code",[_._v("book")]),_._v("查询账户下所有产品类型")]),_._v(" "),e("li",[_._v("如果包含 "),e("code",[_._v("FXSPOT")]),_._v(" 则直接走外汇即期拆分流程")]),_._v(" "),e("li",[_._v("如果不包含，远期只推送现金流到头寸，组装现金流\n"),e("ol",[e("li",[_._v("发送头寸状态为不发送")]),_._v(" "),e("li",[_._v("发送现金流状态为发送")]),_._v(" "),e("li",[_._v("头寸统计状态为无需统计 "),e("code",[_._v("positionCountStatus=4")])]),_._v(" "),e("li",[_._v("更新源bookKeeping记录")])])]),_._v(" "),e("li",[_._v("返回统计结果")])])])])]),_._v(" "),e("li",[e("p",[_._v("拆分失败")]),_._v(" "),e("ol",[e("li",[_._v("设置失败原因")]),_._v(" "),e("li",[_._v("设置头寸统计状态 "),e("code",[_._v("positionCountStatus=1")]),_._v(" ,未统计")]),_._v(" "),e("li",[_._v("更新 "),e("code",[_._v("fmut2_trade_bookkeeping")]),_._v(" 表")])])]),_._v(" "),e("li",[e("p",[_._v("拆分结果 "),e("code",[_._v("TradeSendPojoResult")]),_._v(" 写入事件流 执行下一步send操作，结果包含")]),_._v(" "),e("ol",[e("li",[_._v("需要累计的头寸集合")]),_._v(" "),e("li",[_._v("需要累计的现金流集合")])])])]),_._v(" "),e("h2",{attrs:{id:"二、做市交易流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、做市交易流程"}},[_._v("#")]),_._v(" 二、做市交易流程")]),_._v(" "),e("h3",{attrs:{id:"交易拆分"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#交易拆分"}},[_._v("#")]),_._v(" 交易拆分")]),_._v(" "),e("h4",{attrs:{id:"_1、即期"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、即期"}},[_._v("#")]),_._v(" 1、即期")]),_._v(" "),e("h4",{attrs:{id:"_2、远期"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、远期"}},[_._v("#")]),_._v(" 2、远期")]),_._v(" "),e("p",[e("strong",[_._v("规则")])]),_._v(" "),e("ol",[e("li",[_._v("贵金属远期交易，不记录头寸和现金流，只更改状态")]),_._v(" "),e("li",[_._v("配置"),e("code",[_._v("need.count.position.books")]),_._v("外的不记录"),e("code",[_._v("头寸")]),_._v("，只记录"),e("code",[_._v("现金流")])]),_._v(" "),e("li",[_._v("配置"),e("code",[_._v("need.count.position.books")]),_._v("的组合的成交，记录"),e("code",[_._v("头寸")]),_._v("和"),e("code",[_._v("现金流")]),_._v("，并且根据配置的"),e("code",[_._v("拆分货币")]),_._v("进行拆分\n"),e("ol",[e("li",[_._v("封装账号头寸信息")]),_._v(" "),e("li",[_._v("封装账户现金流信息")]),_._v(" "),e("li",[_._v("如果是策略成交，封装头寸和现金流信息，且头寸信息不拆分")])])])]),_._v(" "),e("h2",{attrs:{id:"三、交易冲正"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、交易冲正"}},[_._v("#")]),_._v(" 三、交易冲正")]),_._v(" "),e("p",[e("strong",[_._v("交易冲正")])]),_._v(" "),e("blockquote",[e("p",[e("code",[_._v("TRADEMGR0048")]),_._v("  冲正"),e("code",[_._v("tranCode")])])]),_._v(" "),e("h2",{attrs:{id:"四、交易补录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、交易补录"}},[_._v("#")]),_._v(" 四、交易补录")]),_._v(" "),e("p",[e("strong",[_._v("交易补录")])]),_._v(" "),e("blockquote",[e("p",[e("code",[_._v("TRADEMGR0037")]),_._v("   补录 "),e("code",[_._v("tranCode")])])])])}),[],!1,null,null,null);v.default=o.exports}}]);